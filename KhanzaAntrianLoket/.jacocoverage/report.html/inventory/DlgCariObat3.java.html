<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>DlgCariObat3.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;KhanzaHMS&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">inventory</a> &gt; <span class="el_source">DlgCariObat3.java</span></div><h1>DlgCariObat3.java</h1><pre class="source lang-java linenums">/*
  Dilarang keras menggandakan/mengcopy/menyebarkan/membajak/mendecompile 
  Software ini dalam bentuk apapun tanpa seijin pembuat software
  (Khanza.Soft Media). Bagi yang sengaja membajak softaware ini ta
  npa ijin, kami sumpahi sial 1000 turunan, miskin sampai 500 turu
  nan. Selalu mendapat kecelakaan sampai 400 turunan. Anak pertama
  nya cacat tidak punya kaki sampai 300 turunan. Susah cari jodoh
  sampai umur 50 tahun sampai 200 turunan. Ya Alloh maafkan kami 
  karena telah berdoa buruk, semua ini kami lakukan karena kami ti
  dak pernah rela karya kami dibajak tanpa ijin.
 */

package inventory;

import fungsi.WarnaTable;
import fungsi.koneksiDB;
import fungsi.sekuel;
import fungsi.validasi;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.event.KeyEvent;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableColumn;
import khanzahms.DlgCariPenyakit;

/**
 *
 * @author dosen
 */
public final class DlgCariObat3 extends javax.swing.JDialog {
    private final DefaultTableModel tabMode;
<span class="fc" id="L44">    private final sekuel Sequel=new sekuel();</span>
<span class="fc" id="L45">    private final validasi Valid=new validasi();</span>
<span class="fc" id="L46">    private final Connection koneksi=koneksiDB.condb();</span>
<span class="fc" id="L47">    private int i=0,jml=0;</span>
    private ResultSet rstampilbarang,rsstokmasuk,rspemberian,rskeluar,rsretur,rscariharga,rspasien;
    private PreparedStatement pstampilbarang,psstokmasuk,pspemberian,pskeluar,psretur,psimpanretur,pscariharga,
                              pshapusobat,pshapusretur,psobatsimpan,psobatsimpan3,psobatsimpan4,pspasien;
<span class="fc" id="L51">    private double stokmasuk=0,pagi=0,siang=0,sore=0,malam=0,keluar=0,retur=0,harga=0,kapasitas=0;</span>
<span class="fc" id="L52">    private DlgCariPenyakit dlgpnykt=new DlgCariPenyakit(null,false);</span>
<span class="fc" id="L53">    private String bangsal=Sequel.cariIsi(&quot;select kd_bangsal from set_lokasi limit 1&quot;);</span>
    /** Creates new form DlgPenyakit
     * @param parent
     * @param modal */
    public DlgCariObat3(java.awt.Frame parent, boolean modal) {
<span class="fc" id="L58">        super(parent, modal);</span>
<span class="fc" id="L59">        initComponents();</span>
<span class="fc" id="L60">        this.setLocation(10,2);</span>
<span class="fc" id="L61">        setSize(856,350);</span>
<span class="fc" id="L62">        Object[] row={&quot;K&quot;,&quot;Kode Barang&quot;,&quot;Nama Barang&quot;,&quot;Stok.Msk&quot;,&quot;Pagi&quot;,&quot;Siang&quot;,&quot;Sore&quot;,&quot;Malam&quot;,&quot;Ttl.Msk&quot;,&quot;Ttl.Klr&quot;,&quot;Retur&quot;,&quot;Rtr.Sh&quot;,&quot;Ttl.Hlg&quot;};</span>
<span class="fc" id="L63">        tabMode=new DefaultTableModel(null,row){</span>
            @Override public boolean isCellEditable(int rowIndex, int colIndex){
<span class="nc" id="L65">                boolean a = true;</span>
<span class="nc bnc" id="L66" title="All 14 branches missed.">                if ((colIndex==1)||(colIndex==2)||(colIndex==3)||(colIndex==8)||(colIndex==9)||(colIndex==11)||(colIndex==12)) {</span>
<span class="nc" id="L67">                    a=false;</span>
                }
<span class="nc" id="L69">                return a;</span>
             }
<span class="fc" id="L71">             Class[] types = new Class[] {</span>
                java.lang.Boolean.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class,
                java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class,
                java.lang.Object.class, java.lang.Object.class, java.lang.Object.class 
             };
             /*Class[] types = new Class[] {
                java.lang.Boolean.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class
             };*/
             @Override
             public Class getColumnClass(int columnIndex) {
<span class="nc" id="L81">                return types [columnIndex];</span>
             }
        };
<span class="fc" id="L84">        tbObat.setModel(tabMode);</span>
        //tbPenyakit.setDefaultRenderer(Object.class, new WarnaTable(panelJudul.getBackground(),tbPenyakit.getBackground()));
<span class="fc" id="L86">        tbObat.setPreferredScrollableViewportSize(new Dimension(500,500));</span>
<span class="fc" id="L87">        tbObat.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);</span>
<span class="fc bfc" id="L88" title="All 2 branches covered.">        for (i = 0; i &lt; 13; i++) {</span>
<span class="fc" id="L89">            TableColumn column = tbObat.getColumnModel().getColumn(i);</span>
<span class="fc bfc" id="L90" title="All 2 branches covered.">            if(i==0){</span>
<span class="fc" id="L91">                column.setPreferredWidth(25);</span>
<span class="fc bfc" id="L92" title="All 2 branches covered.">            }else if(i==1){</span>
<span class="fc" id="L93">                column.setPreferredWidth(90);</span>
<span class="fc bfc" id="L94" title="All 2 branches covered.">            }else if(i==2){</span>
<span class="fc" id="L95">                column.setPreferredWidth(250);</span>
            }else{
<span class="fc" id="L97">                column.setPreferredWidth(60);</span>
            }      
        }
<span class="fc" id="L100">        tbObat.setDefaultRenderer(Object.class, new WarnaTable());            </span>
        
<span class="fc" id="L102">        dlgpnykt.getTabel().addMouseListener(new MouseListener() {</span>
            @Override
            public void mouseClicked(MouseEvent e) {
<span class="nc" id="L105">                TKdPny.setText(dlgpnykt.getTextField().getText());     </span>
<span class="nc" id="L106">                Sequel.cariIsi(&quot;select nm_penyakit from penyakit where kd_penyakit=? &quot;,TNmPny,TKdPny.getText());</span>
<span class="nc" id="L107">            }</span>

            @Override
<span class="nc" id="L110">            public void mousePressed(MouseEvent e) {}</span>
            @Override
<span class="nc" id="L112">            public void mouseReleased(MouseEvent e) {}</span>
            @Override
<span class="nc" id="L114">            public void mouseEntered(MouseEvent e) {}</span>
            @Override
<span class="nc" id="L116">            public void mouseExited(MouseEvent e) {}</span>
        });
        
        try {
<span class="fc" id="L120">            pstampilbarang=koneksi.prepareStatement(</span>
                    &quot;select stok_obat_pasien.kode_brng,databarang.nama_brng,sum(stok_obat_pasien.jumlah) &quot;+
                    &quot;from stok_obat_pasien inner join databarang on databarang.kode_brng=stok_obat_pasien.kode_brng &quot;+
                    &quot;where stok_obat_pasien.no_rawat=? group by stok_obat_pasien.kode_brng order by databarang.nama_brng&quot;);
<span class="fc" id="L124">            psstokmasuk=koneksi.prepareStatement(</span>
                    &quot;select sum(stok_obat_pasien.jumlah) as jumlah from stok_obat_pasien where &quot;+
                    &quot;stok_obat_pasien.no_rawat=? and stok_obat_pasien.tanggal=? and stok_obat_pasien.kode_brng=?&quot;);
<span class="fc" id="L127">            pspemberian=koneksi.prepareStatement(</span>
                    &quot;select sum(detail_pemberian_obat.jml) as jml from detail_pemberian_obat where &quot;+
                    &quot;detail_pemberian_obat.no_rawat=? and detail_pemberian_obat.tgl_perawatan=? and &quot;+
                    &quot;detail_pemberian_obat.kode_brng=? and jam between ? and ?&quot;);
<span class="fc" id="L131">            pskeluar=koneksi.prepareStatement(</span>
                    &quot;select sum(detail_pemberian_obat.jml) as jml from detail_pemberian_obat where &quot;+
                    &quot;detail_pemberian_obat.no_rawat=? and detail_pemberian_obat.kode_brng=?&quot;);
<span class="fc" id="L134">            psretur=koneksi.prepareStatement(</span>
                    &quot;select sum(returpasien.jml) as jml from returpasien where &quot;+
                    &quot;returpasien.no_rawat=? and returpasien.kode_brng=?&quot;);
<span class="fc" id="L137">            pshapusobat=koneksi.prepareStatement(</span>
                    &quot;delete from detail_pemberian_obat where detail_pemberian_obat.no_rawat=? and &quot;+
                    &quot;detail_pemberian_obat.tgl_perawatan=? and detail_pemberian_obat.kode_brng=? &quot;);
<span class="fc" id="L140">            pshapusretur=koneksi.prepareStatement(</span>
                    &quot;delete from returpasien where returpasien.no_rawat=? and returpasien.kode_brng=? &quot;);
<span class="fc" id="L142">            psobatsimpan= koneksi.prepareStatement(&quot;insert into detail_pemberian_obat values(?,?,?,?,?,?,?,?,?,?)&quot;);</span>
<span class="fc" id="L143">            psobatsimpan3= koneksi.prepareStatement(&quot;update gudangbarang set stok=stok-? where kode_brng=? and kd_bangsal=?&quot;);           </span>
<span class="fc" id="L144">            psobatsimpan4= koneksi.prepareStatement(&quot;update gudangbarang set stok=stok+? where kode_brng=? and kd_bangsal=?&quot;);</span>
<span class="fc" id="L145">            psimpanretur= koneksi.prepareStatement(&quot;insert into returpasien values(?,?,?,?)&quot;);</span>
<span class="fc" id="L146">            pscariharga=koneksi.prepareStatement(&quot;select databarang.h_retail,databarang.h_distributor,databarang.h_grosir,&quot;+</span>
                    &quot;IFNULL(kapasitas,0) as kapasitas from databarang &quot;+
                    &quot;where databarang.kode_brng=?&quot;);
<span class="nc" id="L149">        } catch (SQLException e) {</span>
<span class="nc" id="L150">            System.out.println(e);</span>
<span class="fc" id="L151">        }</span>
<span class="fc" id="L152">    }    </span>
    

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
    private void initComponents() {

<span class="fc" id="L164">        TNoRw = new widget.TextBox();</span>
<span class="fc" id="L165">        Kd2 = new widget.TextBox();</span>
<span class="fc" id="L166">        internalFrame1 = new widget.InternalFrame();</span>
<span class="fc" id="L167">        Scroll = new widget.ScrollPane();</span>
<span class="fc" id="L168">        tbObat = new widget.Table();</span>
<span class="fc" id="L169">        panelisi3 = new widget.panelisi();</span>
<span class="fc" id="L170">        label12 = new widget.Label();</span>
<span class="fc" id="L171">        Jenisjual = new widget.ComboBox();</span>
<span class="fc" id="L172">        label13 = new widget.Label();</span>
<span class="fc" id="L173">        BtnSimpan = new widget.Button();</span>
<span class="fc" id="L174">        btnCetak = new widget.Button();</span>
<span class="fc" id="L175">        BtnKeluar = new widget.Button();</span>
<span class="fc" id="L176">        FormInput = new widget.PanelBiasa();</span>
<span class="fc" id="L177">        jLabel5 = new widget.Label();</span>
<span class="fc" id="L178">        Tanggal = new widget.Tanggal();</span>
<span class="fc" id="L179">        BtnCari = new widget.Button();</span>
<span class="fc" id="L180">        jLabel12 = new widget.Label();</span>
<span class="fc" id="L181">        TKdPny = new widget.TextBox();</span>
<span class="fc" id="L182">        TNmPny = new widget.TextBox();</span>
<span class="fc" id="L183">        BtnSeek2 = new widget.Button();</span>

<span class="fc" id="L185">        TNoRw.setFont(new java.awt.Font(&quot;Tahoma&quot;, 0, 12)); // NOI18N</span>
<span class="fc" id="L186">        TNoRw.setHighlighter(null);</span>
<span class="fc" id="L187">        TNoRw.setName(&quot;TNoRw&quot;); // NOI18N</span>
<span class="fc" id="L188">        TNoRw.setSelectionColor(new java.awt.Color(255, 255, 255));</span>

<span class="fc" id="L190">        Kd2.setFont(new java.awt.Font(&quot;Tahoma&quot;, 0, 12)); // NOI18N</span>
<span class="fc" id="L191">        Kd2.setHighlighter(null);</span>
<span class="fc" id="L192">        Kd2.setName(&quot;Kd2&quot;); // NOI18N</span>
<span class="fc" id="L193">        Kd2.setSelectionColor(new java.awt.Color(255, 255, 255));</span>
<span class="fc" id="L194">        Kd2.addKeyListener(new java.awt.event.KeyAdapter() {</span>
            public void keyPressed(java.awt.event.KeyEvent evt) {
<span class="nc" id="L196">                Kd2KeyPressed(evt);</span>
<span class="nc" id="L197">            }</span>
        });

<span class="fc" id="L200">        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);</span>
<span class="fc" id="L201">        setUndecorated(true);</span>
<span class="fc" id="L202">        setResizable(false);</span>

<span class="fc" id="L204">        internalFrame1.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(240, 245, 235)), &quot;::[ Data Obat/Alkes/BHP ]::&quot;, javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font(&quot;Tahoma&quot;, 0, 11), new java.awt.Color(50, 70, 40))); // NOI18N</span>
<span class="fc" id="L205">        internalFrame1.setName(&quot;internalFrame1&quot;); // NOI18N</span>
<span class="fc" id="L206">        internalFrame1.setLayout(new java.awt.BorderLayout(1, 1));</span>

<span class="fc" id="L208">        Scroll.setName(&quot;Scroll&quot;); // NOI18N</span>
<span class="fc" id="L209">        Scroll.setOpaque(true);</span>

<span class="fc" id="L211">        tbObat.setToolTipText(&quot;Silahkan klik untuk memilih data yang mau diedit ataupun dihapus&quot;);</span>
<span class="fc" id="L212">        tbObat.setName(&quot;tbObat&quot;); // NOI18N</span>
<span class="fc" id="L213">        tbObat.addMouseListener(new java.awt.event.MouseAdapter() {</span>
            public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L215">                tbObatMouseClicked(evt);</span>
<span class="nc" id="L216">            }</span>
        });
<span class="fc" id="L218">        tbObat.addPropertyChangeListener(new java.beans.PropertyChangeListener() {</span>
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
<span class="fc" id="L220">                tbObatPropertyChange(evt);</span>
<span class="fc" id="L221">            }</span>
        });
<span class="fc" id="L223">        tbObat.addKeyListener(new java.awt.event.KeyAdapter() {</span>
            public void keyPressed(java.awt.event.KeyEvent evt) {
<span class="nc" id="L225">                tbObatKeyPressed(evt);</span>
<span class="nc" id="L226">            }</span>
        });
<span class="fc" id="L228">        Scroll.setViewportView(tbObat);</span>

<span class="fc" id="L230">        internalFrame1.add(Scroll, java.awt.BorderLayout.CENTER);</span>

<span class="fc" id="L232">        panelisi3.setName(&quot;panelisi3&quot;); // NOI18N</span>
<span class="fc" id="L233">        panelisi3.setPreferredSize(new java.awt.Dimension(100, 56));</span>
<span class="fc" id="L234">        panelisi3.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 4, 9));</span>

<span class="fc" id="L236">        label12.setText(&quot;Tarif :&quot;);</span>
<span class="fc" id="L237">        label12.setName(&quot;label12&quot;); // NOI18N</span>
<span class="fc" id="L238">        label12.setPreferredSize(new java.awt.Dimension(50, 23));</span>
<span class="fc" id="L239">        panelisi3.add(label12);</span>

<span class="fc" id="L241">        Jenisjual.setModel(new javax.swing.DefaultComboBoxModel(new String[] { &quot;Ranap Umum&quot;, &quot;Rawat Jalan&quot;, &quot;Ranap BPJS&quot; }));</span>
<span class="fc" id="L242">        Jenisjual.setName(&quot;Jenisjual&quot;); // NOI18N</span>
<span class="fc" id="L243">        Jenisjual.setPreferredSize(new java.awt.Dimension(100, 23));</span>
<span class="fc" id="L244">        panelisi3.add(Jenisjual);</span>

<span class="fc" id="L246">        label13.setName(&quot;label13&quot;); // NOI18N</span>
<span class="fc" id="L247">        label13.setPreferredSize(new java.awt.Dimension(50, 23));</span>
<span class="fc" id="L248">        panelisi3.add(label13);</span>

<span class="fc" id="L250">        BtnSimpan.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/picture/save-16x16.png&quot;))); // NOI18N</span>
<span class="fc" id="L251">        BtnSimpan.setMnemonic('S');</span>
<span class="fc" id="L252">        BtnSimpan.setText(&quot;Simpan&quot;);</span>
<span class="fc" id="L253">        BtnSimpan.setToolTipText(&quot;Alt+S&quot;);</span>
<span class="fc" id="L254">        BtnSimpan.setName(&quot;BtnSimpan&quot;); // NOI18N</span>
<span class="fc" id="L255">        BtnSimpan.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L257">                BtnSimpanActionPerformed(evt);</span>
<span class="nc" id="L258">            }</span>
        });
<span class="fc" id="L260">        panelisi3.add(BtnSimpan);</span>

<span class="fc" id="L262">        btnCetak.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/picture/b_print.png&quot;))); // NOI18N</span>
<span class="fc" id="L263">        btnCetak.setMnemonic('T');</span>
<span class="fc" id="L264">        btnCetak.setText(&quot;Cetak&quot;);</span>
<span class="fc" id="L265">        btnCetak.setToolTipText(&quot;Alt+T&quot;);</span>
<span class="fc" id="L266">        btnCetak.setName(&quot;btnCetak&quot;); // NOI18N</span>
<span class="fc" id="L267">        btnCetak.setPreferredSize(new java.awt.Dimension(92, 36));</span>
<span class="fc" id="L268">        btnCetak.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L270">                btnCetakActionPerformed(evt);</span>
<span class="nc" id="L271">            }</span>
        });
<span class="fc" id="L273">        panelisi3.add(btnCetak);</span>

<span class="fc" id="L275">        BtnKeluar.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/picture/exit.png&quot;))); // NOI18N</span>
<span class="fc" id="L276">        BtnKeluar.setMnemonic('K');</span>
<span class="fc" id="L277">        BtnKeluar.setText(&quot;Keluar&quot;);</span>
<span class="fc" id="L278">        BtnKeluar.setToolTipText(&quot;Alt+K&quot;);</span>
<span class="fc" id="L279">        BtnKeluar.setName(&quot;BtnKeluar&quot;); // NOI18N</span>
<span class="fc" id="L280">        BtnKeluar.setPreferredSize(new java.awt.Dimension(92, 36));</span>
<span class="fc" id="L281">        BtnKeluar.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L283">                BtnKeluarActionPerformed(evt);</span>
<span class="nc" id="L284">            }</span>
        });
<span class="fc" id="L286">        panelisi3.add(BtnKeluar);</span>

<span class="fc" id="L288">        internalFrame1.add(panelisi3, java.awt.BorderLayout.PAGE_END);</span>

<span class="fc" id="L290">        FormInput.setBackground(new java.awt.Color(215, 225, 215));</span>
<span class="fc" id="L291">        FormInput.setName(&quot;FormInput&quot;); // NOI18N</span>
<span class="fc" id="L292">        FormInput.setPreferredSize(new java.awt.Dimension(100, 43));</span>
<span class="fc" id="L293">        FormInput.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 3, 9));</span>

<span class="fc" id="L295">        jLabel5.setText(&quot;Tanggal :&quot;);</span>
<span class="fc" id="L296">        jLabel5.setName(&quot;jLabel5&quot;); // NOI18N</span>
<span class="fc" id="L297">        jLabel5.setPreferredSize(new java.awt.Dimension(60, 23));</span>
<span class="fc" id="L298">        FormInput.add(jLabel5);</span>

<span class="fc" id="L300">        Tanggal.setEditable(false);</span>
<span class="fc" id="L301">        Tanggal.setForeground(new java.awt.Color(50, 70, 50));</span>
<span class="fc" id="L302">        Tanggal.setModel(new javax.swing.DefaultComboBoxModel(new String[] { &quot;2014-06-08&quot; }));</span>
<span class="fc" id="L303">        Tanggal.setDisplayFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="fc" id="L304">        Tanggal.setName(&quot;Tanggal&quot;); // NOI18N</span>
<span class="fc" id="L305">        Tanggal.setOpaque(false);</span>
<span class="fc" id="L306">        Tanggal.setPreferredSize(new java.awt.Dimension(100, 23));</span>
<span class="fc" id="L307">        Tanggal.addKeyListener(new java.awt.event.KeyAdapter() {</span>
            public void keyPressed(java.awt.event.KeyEvent evt) {
<span class="nc" id="L309">                TanggalKeyPressed(evt);</span>
<span class="nc" id="L310">            }</span>
        });
<span class="fc" id="L312">        FormInput.add(Tanggal);</span>

<span class="fc" id="L314">        BtnCari.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/picture/accept.png&quot;))); // NOI18N</span>
<span class="fc" id="L315">        BtnCari.setMnemonic('1');</span>
<span class="fc" id="L316">        BtnCari.setToolTipText(&quot;Alt+1&quot;);</span>
<span class="fc" id="L317">        BtnCari.setFont(new java.awt.Font(&quot;Tahoma&quot;, 1, 12)); // NOI18N</span>
<span class="fc" id="L318">        BtnCari.setName(&quot;BtnCari&quot;); // NOI18N</span>
<span class="fc" id="L319">        BtnCari.setPreferredSize(new java.awt.Dimension(28, 23));</span>
<span class="fc" id="L320">        BtnCari.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L322">                BtnCariActionPerformed(evt);</span>
<span class="nc" id="L323">            }</span>
        });
<span class="fc" id="L325">        FormInput.add(BtnCari);</span>

<span class="fc" id="L327">        jLabel12.setText(&quot;Penyakit :&quot;);</span>
<span class="fc" id="L328">        jLabel12.setName(&quot;jLabel12&quot;); // NOI18N</span>
<span class="fc" id="L329">        jLabel12.setPreferredSize(new java.awt.Dimension(65, 23));</span>
<span class="fc" id="L330">        FormInput.add(jLabel12);</span>

<span class="fc" id="L332">        TKdPny.setText(&quot;-&quot;);</span>
<span class="fc" id="L333">        TKdPny.setFont(new java.awt.Font(&quot;Tahoma&quot;, 0, 12)); // NOI18N</span>
<span class="fc" id="L334">        TKdPny.setName(&quot;TKdPny&quot;); // NOI18N</span>
<span class="fc" id="L335">        TKdPny.setPreferredSize(new java.awt.Dimension(100, 23));</span>
<span class="fc" id="L336">        TKdPny.addKeyListener(new java.awt.event.KeyAdapter() {</span>
            public void keyPressed(java.awt.event.KeyEvent evt) {
<span class="nc" id="L338">                TKdPnyKeyPressed(evt);</span>
<span class="nc" id="L339">            }</span>
        });
<span class="fc" id="L341">        FormInput.add(TKdPny);</span>

<span class="fc" id="L343">        TNmPny.setEditable(false);</span>
<span class="fc" id="L344">        TNmPny.setText(&quot;-&quot;);</span>
<span class="fc" id="L345">        TNmPny.setFont(new java.awt.Font(&quot;Tahoma&quot;, 0, 12)); // NOI18N</span>
<span class="fc" id="L346">        TNmPny.setName(&quot;TNmPny&quot;); // NOI18N</span>
<span class="fc" id="L347">        TNmPny.setPreferredSize(new java.awt.Dimension(246, 23));</span>
<span class="fc" id="L348">        FormInput.add(TNmPny);</span>

<span class="fc" id="L350">        BtnSeek2.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/picture/190.png&quot;))); // NOI18N</span>
<span class="fc" id="L351">        BtnSeek2.setMnemonic('2');</span>
<span class="fc" id="L352">        BtnSeek2.setToolTipText(&quot;Alt+2&quot;);</span>
<span class="fc" id="L353">        BtnSeek2.setFont(new java.awt.Font(&quot;Tahoma&quot;, 1, 12)); // NOI18N</span>
<span class="fc" id="L354">        BtnSeek2.setName(&quot;BtnSeek2&quot;); // NOI18N</span>
<span class="fc" id="L355">        BtnSeek2.setPreferredSize(new java.awt.Dimension(28, 23));</span>
<span class="fc" id="L356">        BtnSeek2.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L358">                BtnSeek2ActionPerformed(evt);</span>
<span class="nc" id="L359">            }</span>
        });
<span class="fc" id="L361">        BtnSeek2.addKeyListener(new java.awt.event.KeyAdapter() {</span>
            public void keyPressed(java.awt.event.KeyEvent evt) {
<span class="nc" id="L363">                BtnSeek2KeyPressed(evt);</span>
<span class="nc" id="L364">            }</span>
        });
<span class="fc" id="L366">        FormInput.add(BtnSeek2);</span>

<span class="fc" id="L368">        internalFrame1.add(FormInput, java.awt.BorderLayout.PAGE_START);</span>

<span class="fc" id="L370">        getContentPane().add(internalFrame1, java.awt.BorderLayout.CENTER);</span>

<span class="fc" id="L372">        pack();</span>
<span class="fc" id="L373">    }// &lt;/editor-fold&gt;//GEN-END:initComponents</span>


    private void tbObatKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tbObatKeyPressed
<span class="nc bnc" id="L377" title="All 2 branches missed.">        if(tbObat.getRowCount()!=0){</span>
<span class="nc bnc" id="L378" title="All 2 branches missed.">            if(evt.getKeyCode()==KeyEvent.VK_DELETE){</span>
<span class="nc bnc" id="L379" title="All 2 branches missed.">                if(tbObat.getSelectedRow()!= -1){</span>
<span class="nc bnc" id="L380" title="All 10 branches missed.">                    if((tbObat.getSelectedColumn()==4)||(tbObat.getSelectedColumn()==5)||(tbObat.getSelectedColumn()==6)||(tbObat.getSelectedColumn()==7)||(tbObat.getSelectedColumn()==10)){</span>
                        try {            
<span class="nc" id="L382">                            tbObat.setValueAt(&quot;&quot;,tbObat.getSelectedRow(),tbObat.getSelectedColumn());        </span>
<span class="nc" id="L383">                        } catch (Exception e) {</span>
<span class="nc" id="L384">                        }</span>
                    }                    
                }
<span class="nc bnc" id="L387" title="All 2 branches missed.">            }else if(evt.getKeyCode()==KeyEvent.VK_SPACE){</span>
<span class="nc" id="L388">                dispose();</span>
            } 
        }
<span class="nc" id="L391">}//GEN-LAST:event_tbObatKeyPressed</span>

    private void BtnKeluarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnKeluarActionPerformed
<span class="nc" id="L394">       dispose();</span>
<span class="nc" id="L395">    }//GEN-LAST:event_BtnKeluarActionPerformed</span>

private void BtnSimpanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnSimpanActionPerformed
<span class="nc bnc" id="L398" title="All 4 branches missed.">        if(TNoRw.getText().trim().equals(&quot;&quot;)||TKdPny.getText().trim().equals(&quot;&quot;)){</span>
<span class="nc" id="L399">            Valid.textKosong(Jenisjual,&quot;Data&quot;);</span>
<span class="nc bnc" id="L400" title="All 2 branches missed.">        }else if(bangsal.equals(&quot;&quot;)){</span>
<span class="nc" id="L401">            Valid.textKosong(Jenisjual,&quot;Lokasi&quot;);</span>
        }else{
            try {  
<span class="nc" id="L404">                koneksi.setAutoCommit(false); </span>
<span class="nc" id="L405">                jml=tbObat.getRowCount();</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">                for(i=0;i&lt;jml;i++){   </span>
<span class="nc" id="L407">                    harga=0;</span>
<span class="nc" id="L408">                    kapasitas=1;</span>
<span class="nc" id="L409">                    pscariharga.setString(1,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L410">                    rscariharga=pscariharga.executeQuery();</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">                    while(rscariharga.next()){</span>
<span class="nc bnc" id="L412" title="All 2 branches missed.">                        if(Jenisjual.getSelectedItem().equals(&quot;Ranap Umum&quot;)){</span>
<span class="nc" id="L413">                            harga=rscariharga.getDouble(&quot;h_retail&quot;);</span>
<span class="nc bnc" id="L414" title="All 2 branches missed.">                        }else if(Jenisjual.getSelectedItem().equals(&quot;Rawat Jalan&quot;)){</span>
<span class="nc" id="L415">                            harga=rscariharga.getDouble(&quot;h_distributor&quot;);</span>
<span class="nc bnc" id="L416" title="All 2 branches missed.">                        }else if(Jenisjual.getSelectedItem().equals(&quot;Ranap BPJS&quot;)){</span>
<span class="nc" id="L417">                            harga=rscariharga.getDouble(&quot;h_grosir&quot;);</span>
                        }  
<span class="nc bnc" id="L419" title="All 2 branches missed.">                        if(rscariharga.getDouble(&quot;kapasitas&quot;)&gt;0){</span>
<span class="nc" id="L420">                           kapasitas=rscariharga.getDouble(&quot;kapasitas&quot;);                            </span>
                        }
                    }                    
                         
<span class="nc" id="L424">                    pagi=0;</span>
                    try {
<span class="nc" id="L426">                        pagi=Double.parseDouble(tbObat.getValueAt(i,4).toString()); </span>
<span class="nc" id="L427">                    } catch (Exception e) {</span>
<span class="nc" id="L428">                        pagi=0;</span>
<span class="nc" id="L429">                    }</span>
<span class="nc" id="L430">                    siang=0;</span>
                    try {
<span class="nc" id="L432">                        siang=Double.parseDouble(tbObat.getValueAt(i,5).toString()); </span>
<span class="nc" id="L433">                    } catch (Exception e) {</span>
<span class="nc" id="L434">                        siang=0;</span>
<span class="nc" id="L435">                    }</span>
<span class="nc" id="L436">                    sore=0;</span>
                    try {
<span class="nc" id="L438">                        sore=Double.parseDouble(tbObat.getValueAt(i,6).toString()); </span>
<span class="nc" id="L439">                    } catch (Exception e) {</span>
<span class="nc" id="L440">                        sore=0;</span>
<span class="nc" id="L441">                    }</span>
<span class="nc" id="L442">                    malam=0;</span>
                    try {
<span class="nc" id="L444">                        malam=Double.parseDouble(tbObat.getValueAt(i,7).toString()); </span>
<span class="nc" id="L445">                    } catch (Exception e) {</span>
<span class="nc" id="L446">                        malam=0;</span>
<span class="nc" id="L447">                    }</span>
<span class="nc" id="L448">                    retur=0;</span>
                    try {
<span class="nc" id="L450">                        retur=Double.parseDouble(tbObat.getValueAt(i,10).toString()); </span>
<span class="nc" id="L451">                    } catch (Exception e) {</span>
<span class="nc" id="L452">                        retur=0;</span>
<span class="nc" id="L453">                    } </span>
                    
<span class="nc" id="L455">                    pshapusobat.setString(1,TNoRw.getText());</span>
<span class="nc" id="L456">                    pshapusobat.setString(2,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L457">                    pshapusobat.setString(3,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L458">                    pshapusobat.executeUpdate();</span>
                    
<span class="nc bnc" id="L460" title="All 2 branches missed.">                    if(retur&gt;0){</span>
<span class="nc" id="L461">                        pshapusretur.setString(1,TNoRw.getText());</span>
<span class="nc" id="L462">                        pshapusretur.setString(2,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L463">                        pshapusretur.executeUpdate();                        </span>

<span class="nc" id="L465">                        psretur.setString(1,TNoRw.getText());</span>
<span class="nc" id="L466">                        psretur.setString(2,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L467">                        rsretur=psretur.executeQuery();</span>
<span class="nc bnc" id="L468" title="All 2 branches missed.">                        if(rsretur.next()){</span>
<span class="nc" id="L469">                            psobatsimpan3.setDouble(1,rsretur.getDouble(&quot;jml&quot;));</span>
<span class="nc" id="L470">                            psobatsimpan3.setString(2,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L471">                            psobatsimpan3.setString(3,bangsal);</span>
<span class="nc" id="L472">                            psobatsimpan3.executeUpdate(); </span>
                        }                      

<span class="nc" id="L475">                        psimpanretur.setString(1,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L476">                        psimpanretur.setString(2,TNoRw.getText());</span>
<span class="nc" id="L477">                        psimpanretur.setString(3,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L478">                        psimpanretur.setDouble(4,retur);</span>
<span class="nc" id="L479">                        psimpanretur.executeUpdate();</span>
                        
<span class="nc" id="L481">                        psobatsimpan4.setDouble(1,retur);</span>
<span class="nc" id="L482">                        psobatsimpan4.setString(2,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L483">                        psobatsimpan4.setString(3,bangsal);</span>
<span class="nc" id="L484">                        psobatsimpan4.executeUpdate();</span>
                    }                  
                                       
<span class="nc bnc" id="L487" title="All 2 branches missed.">                    if(pagi&gt;0){</span>
<span class="nc" id="L488">                        psobatsimpan.setString(1,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L489">                        psobatsimpan.setString(2,&quot;07:00:00&quot;);</span>
<span class="nc" id="L490">                        psobatsimpan.setString(3,TNoRw.getText());</span>
<span class="nc" id="L491">                        psobatsimpan.setString(4,TKdPny.getText());</span>
<span class="nc" id="L492">                        psobatsimpan.setString(5,&quot;-&quot;);</span>
<span class="nc" id="L493">                        psobatsimpan.setString(6,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L494">                        psobatsimpan.setDouble(7,harga);</span>
<span class="nc bnc" id="L495" title="All 2 branches missed.">                        if(tbObat.getValueAt(i,0).toString().equals(&quot;true&quot;)){                                </span>
<span class="nc" id="L496">                            psobatsimpan.setDouble(8,(pagi/kapasitas));</span>
<span class="nc" id="L497">                            psobatsimpan.setDouble(10,(harga*(pagi/kapasitas)));  </span>
                        }else{                                
<span class="nc" id="L499">                            psobatsimpan.setDouble(8,pagi);</span>
<span class="nc" id="L500">                            psobatsimpan.setDouble(10, harga*pagi);</span>
                        }
<span class="nc" id="L502">                        psobatsimpan.setString(9,&quot;0&quot;);</span>
<span class="nc" id="L503">                        psobatsimpan.executeUpdate();  </span>
                    }
                    
<span class="nc bnc" id="L506" title="All 2 branches missed.">                    if(siang&gt;0){</span>
<span class="nc" id="L507">                        psobatsimpan.setString(1,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L508">                        psobatsimpan.setString(2,&quot;12:00:00&quot;);</span>
<span class="nc" id="L509">                        psobatsimpan.setString(3,TNoRw.getText());</span>
<span class="nc" id="L510">                        psobatsimpan.setString(4,TKdPny.getText());</span>
<span class="nc" id="L511">                        psobatsimpan.setString(5,&quot;-&quot;);</span>
<span class="nc" id="L512">                        psobatsimpan.setString(6,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L513">                        psobatsimpan.setDouble(7,harga);</span>
<span class="nc bnc" id="L514" title="All 2 branches missed.">                        if(tbObat.getValueAt(i,0).toString().equals(&quot;true&quot;)){                                </span>
<span class="nc" id="L515">                            psobatsimpan.setDouble(8,(siang/kapasitas));</span>
<span class="nc" id="L516">                            psobatsimpan.setDouble(10,(harga*(siang/kapasitas)));    </span>
                        }else{                                
<span class="nc" id="L518">                            psobatsimpan.setDouble(8,siang);</span>
<span class="nc" id="L519">                            psobatsimpan.setDouble(10, harga*siang);</span>
                        }
<span class="nc" id="L521">                        psobatsimpan.setString(9,&quot;0&quot;);</span>
<span class="nc" id="L522">                        psobatsimpan.executeUpdate();  </span>
                    }
                    
<span class="nc bnc" id="L525" title="All 2 branches missed.">                    if(sore&gt;0){</span>
<span class="nc" id="L526">                        psobatsimpan.setString(1,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L527">                        psobatsimpan.setString(2,&quot;16:00:00&quot;);</span>
<span class="nc" id="L528">                        psobatsimpan.setString(3,TNoRw.getText());</span>
<span class="nc" id="L529">                        psobatsimpan.setString(4,TKdPny.getText());</span>
<span class="nc" id="L530">                        psobatsimpan.setString(5,&quot;-&quot;);</span>
<span class="nc" id="L531">                        psobatsimpan.setString(6,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L532">                        psobatsimpan.setDouble(7,harga);</span>
<span class="nc bnc" id="L533" title="All 2 branches missed.">                        if(tbObat.getValueAt(i,0).toString().equals(&quot;true&quot;)){                                </span>
<span class="nc" id="L534">                            psobatsimpan.setDouble(8,(sore/kapasitas));</span>
<span class="nc" id="L535">                            psobatsimpan.setDouble(10,(harga*(sore/kapasitas)));    </span>
                        }else{                                
<span class="nc" id="L537">                            psobatsimpan.setDouble(8,sore);</span>
<span class="nc" id="L538">                            psobatsimpan.setDouble(10, harga*sore);</span>
                        }
<span class="nc" id="L540">                        psobatsimpan.setString(9,&quot;0&quot;);</span>
<span class="nc" id="L541">                        psobatsimpan.executeUpdate();  </span>
                    }
                    
<span class="nc bnc" id="L544" title="All 2 branches missed.">                    if(malam&gt;0){</span>
<span class="nc" id="L545">                        psobatsimpan.setString(1,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L546">                        psobatsimpan.setString(2,&quot;20:00:00&quot;);</span>
<span class="nc" id="L547">                        psobatsimpan.setString(3,TNoRw.getText());</span>
<span class="nc" id="L548">                        psobatsimpan.setString(4,TKdPny.getText());</span>
<span class="nc" id="L549">                        psobatsimpan.setString(5,&quot;-&quot;);</span>
<span class="nc" id="L550">                        psobatsimpan.setString(6,tbObat.getValueAt(i,1).toString());</span>
<span class="nc" id="L551">                        psobatsimpan.setDouble(7,harga);</span>
<span class="nc bnc" id="L552" title="All 2 branches missed.">                        if(tbObat.getValueAt(i,0).toString().equals(&quot;true&quot;)){                                </span>
<span class="nc" id="L553">                            psobatsimpan.setDouble(8,(malam/kapasitas));</span>
<span class="nc" id="L554">                            psobatsimpan.setDouble(10,(harga*(malam/kapasitas)));  </span>
                        }else{                                
<span class="nc" id="L556">                            psobatsimpan.setDouble(8,malam);</span>
<span class="nc" id="L557">                            psobatsimpan.setDouble(10, harga*malam);</span>
                        }
<span class="nc" id="L559">                        psobatsimpan.setString(9,&quot;0&quot;);</span>
<span class="nc" id="L560">                        psobatsimpan.executeUpdate();  </span>
                    }                  
                }    
<span class="nc" id="L563">                koneksi.setAutoCommit(true);</span>
<span class="nc" id="L564">                tampil(); </span>
<span class="nc" id="L565">            }catch(Exception e){</span>
<span class="nc" id="L566">                System.out.println(e);</span>
<span class="nc" id="L567">            }</span>
        }
<span class="nc" id="L569">}//GEN-LAST:event_BtnSimpanActionPerformed</span>

private void TanggalKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_TanggalKeyPressed
<span class="nc" id="L572">    Valid.pindah(evt,BtnKeluar,TKdPny);</span>
<span class="nc" id="L573">}//GEN-LAST:event_TanggalKeyPressed</span>

private void TKdPnyKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_TKdPnyKeyPressed
<span class="nc bnc" id="L576" title="All 2 branches missed.">       if(evt.getKeyCode()==KeyEvent.VK_PAGE_DOWN){</span>
<span class="nc" id="L577">            Sequel.cariIsi(&quot;select nm_penyakit from penyakit where kd_penyakit=? &quot;,TNmPny,TKdPny.getText());</span>
        }else{            
<span class="nc" id="L579">            Valid.pindah(evt,TNoRw,BtnSimpan);</span>
        }        
<span class="nc" id="L581">}//GEN-LAST:event_TKdPnyKeyPressed</span>

private void BtnSeek2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnSeek2ActionPerformed
<span class="nc" id="L584">        dlgpnykt.emptTeks();</span>
<span class="nc" id="L585">        dlgpnykt.isCek();</span>
<span class="nc" id="L586">        dlgpnykt.tampil();</span>
<span class="nc" id="L587">        dlgpnykt.setSize(this.getWidth()-40,this.getHeight()-40);</span>
<span class="nc" id="L588">        dlgpnykt.setLocationRelativeTo(internalFrame1);</span>
<span class="nc" id="L589">        dlgpnykt.setAlwaysOnTop(false);</span>
<span class="nc" id="L590">        dlgpnykt.setVisible(true);        </span>
<span class="nc" id="L591">}//GEN-LAST:event_BtnSeek2ActionPerformed</span>

private void BtnSeek2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_BtnSeek2KeyPressed
<span class="nc" id="L594">    Valid.pindah(evt,TKdPny,BtnSimpan);</span>
<span class="nc" id="L595">}//GEN-LAST:event_BtnSeek2KeyPressed</span>

    private void BtnCariActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnCariActionPerformed
<span class="nc" id="L598">        tampil();</span>
<span class="nc" id="L599">    }//GEN-LAST:event_BtnCariActionPerformed</span>

    private void btnCetakActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCetakActionPerformed
<span class="nc" id="L602">        this.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));</span>
<span class="nc bnc" id="L603" title="All 2 branches missed.">        if(TNoRw.getText().equals(&quot;&quot;)){</span>
<span class="nc" id="L604">            Valid.textKosong(TNoRw,&quot;Pasien&quot;);</span>
<span class="nc bnc" id="L605" title="All 2 branches missed.">        }else if(tbObat.getRowCount()==0){</span>
<span class="nc" id="L606">            Valid.textKosong(Tanggal,&quot;Data Obat&quot;);</span>
        }else{
            try {
<span class="nc" id="L609">                pspasien=koneksi.prepareStatement(</span>
                        &quot;select pasien.no_rkm_medis,pasien.nm_pasien,pasien.jk,pasien.umur from pasien inner join reg_periksa on reg_periksa.no_rkm_medis=pasien.no_rkm_medis &quot;+
                                &quot;where reg_periksa.no_rawat=?&quot;);
<span class="nc" id="L612">                pspasien.setString(1,TNoRw.getText());</span>
<span class="nc" id="L613">                rspasien=pspasien.executeQuery();</span>
<span class="nc bnc" id="L614" title="All 2 branches missed.">                while(rspasien.next()){</span>
<span class="nc" id="L615">                    Sequel.queryu(&quot;delete from temporary&quot;);</span>
<span class="nc bnc" id="L616" title="All 2 branches missed.">                    for(i=0;i&lt;tbObat.getRowCount();i++){</span>
<span class="nc" id="L617">                        Sequel.menyimpan(&quot;temporary&quot;,&quot;'0','&quot;+</span>
<span class="nc" id="L618">                                tbObat.getValueAt(i,2).toString()+&quot;','&quot;+</span>
<span class="nc" id="L619">                                tbObat.getValueAt(i,3).toString()+&quot;','&quot;+</span>
<span class="nc" id="L620">                                tbObat.getValueAt(i,4).toString()+&quot;','&quot;+</span>
<span class="nc" id="L621">                                tbObat.getValueAt(i,5).toString()+&quot;','&quot;+</span>
<span class="nc" id="L622">                                tbObat.getValueAt(i,6).toString()+&quot;','&quot;+</span>
<span class="nc" id="L623">                                tbObat.getValueAt(i,7).toString()+&quot;','&quot;+</span>
<span class="nc" id="L624">                                tbObat.getValueAt(i,8).toString()+&quot;','&quot;+</span>
<span class="nc" id="L625">                                tbObat.getValueAt(i,9).toString()+&quot;','&quot;+</span>
<span class="nc" id="L626">                                tbObat.getValueAt(i,10).toString()+&quot;','&quot;+</span>
<span class="nc" id="L627">                                tbObat.getValueAt(i,11).toString()+&quot;','&quot;+</span>
<span class="nc" id="L628">                                tbObat.getValueAt(i,12).toString()+&quot;','','','','','',''&quot;,&quot;Data User&quot;);</span>
                    }
<span class="nc" id="L630">                    Map&lt;String, Object&gt; param = new HashMap&lt;&gt;();</span>
<span class="nc" id="L631">                    param.put(&quot;norm&quot;,rspasien.getString(&quot;no_rkm_medis&quot;));</span>
<span class="nc" id="L632">                    param.put(&quot;namapasien&quot;,rspasien.getString(&quot;nm_pasien&quot;));</span>
<span class="nc" id="L633">                    param.put(&quot;jkel&quot;,rspasien.getString(&quot;jk&quot;));</span>
<span class="nc" id="L634">                    param.put(&quot;umur&quot;,rspasien.getString(&quot;umur&quot;));</span>
<span class="nc" id="L635">                    param.put(&quot;tanggal&quot;,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L636">                    Valid.MyReport(&quot;rptObatPasien.jrxml&quot;,&quot;report&quot;,&quot;::[ Obat Keluar Masuk ]::&quot;,</span>
                            &quot;select no, temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8, temp9, temp10, temp11, temp12, temp13, temp14, temp14, temp15, temp16 from temporary order by no asc&quot;,param);
<span class="nc" id="L638">                }                </span>
<span class="nc" id="L639">            } catch (Exception ex) {</span>
<span class="nc" id="L640">                System.out.println(ex);</span>
<span class="nc" id="L641">            }</span>
        }
<span class="nc" id="L643">        this.setCursor(Cursor.getDefaultCursor());</span>
<span class="nc" id="L644">    }//GEN-LAST:event_btnCetakActionPerformed</span>

    private void tbObatPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tbObatPropertyChange
<span class="pc bpc" id="L647" title="1 of 2 branches missed.">        if(this.isVisible()==true){</span>
<span class="nc" id="L648">            getData();</span>
        }
<span class="fc" id="L650">    }//GEN-LAST:event_tbObatPropertyChange</span>

    private void tbObatMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbObatMouseClicked
<span class="nc bnc" id="L653" title="All 2 branches missed.">        if(tbObat.getRowCount()!=0){</span>
            try {
<span class="nc" id="L655">                getData();</span>
<span class="nc" id="L656">            } catch (java.lang.NullPointerException e) {</span>
<span class="nc" id="L657">            }</span>
            
<span class="nc bnc" id="L659" title="All 2 branches missed.">            if(evt.getClickCount()==2){</span>
<span class="nc" id="L660">                dispose();</span>
            }
        }
<span class="nc" id="L663">    }//GEN-LAST:event_tbObatMouseClicked</span>

    private void Kd2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Kd2KeyPressed
        // TODO add your handling code here:
<span class="nc" id="L667">    }//GEN-LAST:event_Kd2KeyPressed</span>

    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
<span class="nc" id="L673">        java.awt.EventQueue.invokeLater(() -&gt; {</span>
            DlgCariObat3 dialog = new DlgCariObat3(new javax.swing.JFrame(), true);
<span class="nc" id="L675">            dialog.addWindowListener(new java.awt.event.WindowAdapter() {</span>
                @Override
                public void windowClosing(java.awt.event.WindowEvent e) {
<span class="nc" id="L678">                    System.exit(0);</span>
<span class="nc" id="L679">                }</span>
            });
            dialog.setVisible(true);
        });
<span class="nc" id="L683">    }</span>

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private widget.Button BtnCari;
    private widget.Button BtnKeluar;
    private widget.Button BtnSeek2;
    private widget.Button BtnSimpan;
    private widget.PanelBiasa FormInput;
    private widget.ComboBox Jenisjual;
    private widget.TextBox Kd2;
    private widget.ScrollPane Scroll;
    private widget.TextBox TKdPny;
    private widget.TextBox TNmPny;
    private widget.TextBox TNoRw;
    private widget.Tanggal Tanggal;
    private widget.Button btnCetak;
    private widget.InternalFrame internalFrame1;
    private widget.Label jLabel12;
    private widget.Label jLabel5;
    private widget.Label label12;
    private widget.Label label13;
    private widget.panelisi panelisi3;
    private widget.Table tbObat;
    // End of variables declaration//GEN-END:variables

    
    public void tampil() {         
        try {             
<span class="nc" id="L711">            Valid.tabelKosong(tabMode);</span>
<span class="nc" id="L712">            pstampilbarang.setString(1,TNoRw.getText());</span>
<span class="nc" id="L713">            rstampilbarang=pstampilbarang.executeQuery();</span>
<span class="nc bnc" id="L714" title="All 2 branches missed.">            while(rstampilbarang.next()){</span>
<span class="nc" id="L715">                stokmasuk=0;</span>
<span class="nc" id="L716">                psstokmasuk.setString(1,TNoRw.getText());</span>
<span class="nc" id="L717">                psstokmasuk.setString(2,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L718">                psstokmasuk.setString(3,rstampilbarang.getString(&quot;kode_brng&quot;));</span>
<span class="nc" id="L719">                rsstokmasuk=psstokmasuk.executeQuery();</span>
<span class="nc bnc" id="L720" title="All 2 branches missed.">                if(rsstokmasuk.next()){</span>
<span class="nc" id="L721">                    stokmasuk=rsstokmasuk.getDouble(&quot;jumlah&quot;);</span>
                }
                
<span class="nc" id="L724">                pagi=0;</span>
<span class="nc" id="L725">                pspemberian.setString(1,TNoRw.getText());</span>
<span class="nc" id="L726">                pspemberian.setString(2,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L727">                pspemberian.setString(3,rstampilbarang.getString(&quot;kode_brng&quot;));</span>
<span class="nc" id="L728">                pspemberian.setString(4,&quot;00:00:01&quot;);</span>
<span class="nc" id="L729">                pspemberian.setString(5,&quot;10:00:00&quot;);</span>
<span class="nc" id="L730">                rspemberian=pspemberian.executeQuery();</span>
<span class="nc bnc" id="L731" title="All 2 branches missed.">                if(rspemberian.next()){</span>
<span class="nc" id="L732">                    pagi=rspemberian.getDouble(&quot;jml&quot;);</span>
                }
                
<span class="nc" id="L735">                siang=0;</span>
<span class="nc" id="L736">                pspemberian.setString(1,TNoRw.getText());</span>
<span class="nc" id="L737">                pspemberian.setString(2,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L738">                pspemberian.setString(3,rstampilbarang.getString(&quot;kode_brng&quot;));</span>
<span class="nc" id="L739">                pspemberian.setString(4,&quot;10:00:01&quot;);</span>
<span class="nc" id="L740">                pspemberian.setString(5,&quot;15:00:00&quot;);</span>
<span class="nc" id="L741">                rspemberian=pspemberian.executeQuery();</span>
<span class="nc bnc" id="L742" title="All 2 branches missed.">                if(rspemberian.next()){</span>
<span class="nc" id="L743">                    siang=rspemberian.getDouble(&quot;jml&quot;);</span>
                }
                
<span class="nc" id="L746">                sore=0;</span>
<span class="nc" id="L747">                pspemberian.setString(1,TNoRw.getText());</span>
<span class="nc" id="L748">                pspemberian.setString(2,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L749">                pspemberian.setString(3,rstampilbarang.getString(&quot;kode_brng&quot;));</span>
<span class="nc" id="L750">                pspemberian.setString(4,&quot;15:00:01&quot;);</span>
<span class="nc" id="L751">                pspemberian.setString(5,&quot;19:00:00&quot;);</span>
<span class="nc" id="L752">                rspemberian=pspemberian.executeQuery();</span>
<span class="nc bnc" id="L753" title="All 2 branches missed.">                if(rspemberian.next()){</span>
<span class="nc" id="L754">                    sore=rspemberian.getDouble(&quot;jml&quot;);</span>
                }
                
<span class="nc" id="L757">                malam=0;</span>
<span class="nc" id="L758">                pspemberian.setString(1,TNoRw.getText());</span>
<span class="nc" id="L759">                pspemberian.setString(2,Tanggal.getSelectedItem().toString());</span>
<span class="nc" id="L760">                pspemberian.setString(3,rstampilbarang.getString(&quot;kode_brng&quot;));</span>
<span class="nc" id="L761">                pspemberian.setString(4,&quot;19:00:01&quot;);</span>
<span class="nc" id="L762">                pspemberian.setString(5,&quot;23:59:59&quot;);</span>
<span class="nc" id="L763">                rspemberian=pspemberian.executeQuery();</span>
<span class="nc bnc" id="L764" title="All 2 branches missed.">                if(rspemberian.next()){</span>
<span class="nc" id="L765">                    malam=rspemberian.getDouble(&quot;jml&quot;);</span>
                }
                
<span class="nc" id="L768">                keluar=0;</span>
<span class="nc" id="L769">                pskeluar.setString(1,TNoRw.getText());</span>
<span class="nc" id="L770">                pskeluar.setString(2,rstampilbarang.getString(&quot;kode_brng&quot;));</span>
<span class="nc" id="L771">                rskeluar=pskeluar.executeQuery();</span>
<span class="nc bnc" id="L772" title="All 2 branches missed.">                if(rskeluar.next()){</span>
<span class="nc" id="L773">                    keluar=rskeluar.getDouble(&quot;jml&quot;);</span>
                }
                
<span class="nc" id="L776">                retur=0;</span>
<span class="nc" id="L777">                psretur.setString(1,TNoRw.getText());</span>
<span class="nc" id="L778">                psretur.setString(2,rstampilbarang.getString(&quot;kode_brng&quot;));</span>
<span class="nc" id="L779">                rsretur=psretur.executeQuery();</span>
<span class="nc bnc" id="L780" title="All 2 branches missed.">                if(rsretur.next()){</span>
<span class="nc" id="L781">                    retur=rsretur.getDouble(&quot;jml&quot;);</span>
                }
                
<span class="nc" id="L784">                tabMode.addRow(new Object[]{false,rstampilbarang.getString(&quot;kode_brng&quot;),rstampilbarang.getString(&quot;nama_brng&quot;),stokmasuk,</span>
<span class="nc" id="L785">                           pagi,siang,sore,malam,rstampilbarang.getDouble(3),keluar,retur,(rstampilbarang.getDouble(3)-keluar),((rstampilbarang.getDouble(3)-keluar)-retur)});</span>
            }
<span class="nc" id="L787">        } catch (SQLException e) {</span>
<span class="nc" id="L788">            System.out.println(e);</span>
<span class="nc" id="L789">        }       </span>
<span class="nc" id="L790">    }</span>
    
    public void setNoRm(String norwt,String penyakit,Date tanggal) {        
<span class="nc" id="L793">        TKdPny.setText(penyakit);</span>
<span class="nc" id="L794">        TNoRw.setText(norwt);</span>

<span class="nc" id="L796">        Tanggal.setDate(tanggal);</span>
<span class="nc" id="L797">        tbObat.requestFocus();</span>
<span class="nc" id="L798">    }  </span>
    
    private void getData(){
<span class="nc" id="L801">        int row=tbObat.getSelectedRow();</span>
<span class="nc bnc" id="L802" title="All 2 branches missed.">        if(TNoRw.getText().trim().equals(&quot;&quot;)){</span>
<span class="nc" id="L803">            Valid.textKosong(TNoRw,&quot;No. Rawat&quot;);</span>
<span class="nc bnc" id="L804" title="All 2 branches missed.">        }else if(row!= -1){ </span>
<span class="nc" id="L805">            Kd2.setText(tbObat.getValueAt(tbObat.getSelectedRow(),1).toString());</span>
<span class="nc" id="L806">            int kolom=tbObat.getSelectedColumn();  </span>
<span class="nc bnc" id="L807" title="All 8 branches missed.">            if((kolom==4)||(kolom==5)||(kolom==6)||(kolom==7)){</span>
<span class="nc" id="L808">                pagi=0;</span>
                try {
<span class="nc" id="L810">                    pagi=Double.parseDouble(tbObat.getValueAt(row,4).toString()); </span>
<span class="nc" id="L811">                } catch (Exception e) {</span>
<span class="nc" id="L812">                    pagi=0;</span>
<span class="nc" id="L813">                }</span>
<span class="nc" id="L814">                siang=0;</span>
                try {
<span class="nc" id="L816">                    siang=Double.parseDouble(tbObat.getValueAt(row,5).toString()); </span>
<span class="nc" id="L817">                } catch (Exception e) {</span>
<span class="nc" id="L818">                    siang=0;</span>
<span class="nc" id="L819">                }</span>
<span class="nc" id="L820">                sore=0;</span>
                try {
<span class="nc" id="L822">                    sore=Double.parseDouble(tbObat.getValueAt(row,6).toString()); </span>
<span class="nc" id="L823">                } catch (Exception e) {</span>
<span class="nc" id="L824">                    sore=0;</span>
<span class="nc" id="L825">                }</span>
<span class="nc" id="L826">                malam=0;</span>
                try {
<span class="nc" id="L828">                    malam=Double.parseDouble(tbObat.getValueAt(row,7).toString()); </span>
<span class="nc" id="L829">                } catch (Exception e) {</span>
<span class="nc" id="L830">                    malam=0;</span>
<span class="nc" id="L831">                }</span>
<span class="nc" id="L832">                stokmasuk=0;</span>
                try {
<span class="nc" id="L834">                    stokmasuk=Double.parseDouble(tbObat.getValueAt(row,8).toString());</span>
<span class="nc" id="L835">                } catch (Exception e) {</span>
<span class="nc" id="L836">                    stokmasuk=0;</span>
<span class="nc" id="L837">                }</span>
<span class="nc bnc" id="L838" title="All 2 branches missed.">                if(tbObat.getValueAt(row,0).toString().equals(&quot;false&quot;)){</span>
<span class="nc bnc" id="L839" title="All 2 branches missed.">                    if((stokmasuk-(pagi+siang+sore+malam))&lt;0){</span>
<span class="nc" id="L840">                        JOptionPane.showMessageDialog(null,&quot;Maaf, Stok tidak cukup....!!!&quot;);</span>
<span class="nc" id="L841">                        tbObat.requestFocus();</span>
<span class="nc" id="L842">                        tbObat.setValueAt(&quot;0&quot;, row,kolom);  </span>
                    }else{
<span class="nc" id="L844">                        tbObat.setValueAt(Double.toString(pagi+siang+sore+malam), row,9);  </span>
                    }  
                }else{
                    try {
<span class="nc" id="L848">                        kapasitas=1;</span>
<span class="nc" id="L849">                        pscariharga.setString(1,tbObat.getValueAt(row,1).toString());</span>
<span class="nc" id="L850">                        rscariharga=pscariharga.executeQuery();</span>
<span class="nc bnc" id="L851" title="All 2 branches missed.">                        while(rscariharga.next()){</span>
<span class="nc bnc" id="L852" title="All 2 branches missed.">                            if(rscariharga.getDouble(&quot;kapasitas&quot;)&gt;0){</span>
<span class="nc" id="L853">                                kapasitas=rscariharga.getDouble(&quot;kapasitas&quot;);                                </span>
                            }
                        }
<span class="nc bnc" id="L856" title="All 2 branches missed.">                        if((stokmasuk-((pagi/kapasitas)+(siang/kapasitas)+(sore/kapasitas)+(malam/kapasitas)))&lt;0){</span>
<span class="nc" id="L857">                            JOptionPane.showMessageDialog(null,&quot;Maaf, Stok tidak cukup....!!!&quot;);</span>
<span class="nc" id="L858">                            tbObat.requestFocus();</span>
<span class="nc" id="L859">                            tbObat.setValueAt(&quot;0&quot;, row,kolom);  </span>
                        }else{
<span class="nc" id="L861">                            tbObat.setValueAt(Double.toString((pagi/kapasitas)+(siang/kapasitas)+(sore/kapasitas)+(malam/kapasitas)), row,9);  </span>
                        }
<span class="nc" id="L863">                    } catch (SQLException ex) {</span>
<span class="nc" id="L864">                        System.out.println(ex);</span>
<span class="nc" id="L865">                    }</span>
                }
                                               
<span class="nc bnc" id="L868" title="All 2 branches missed.">            }else if(kolom==10){</span>
<span class="nc" id="L869">                retur=0;</span>
                try {
<span class="nc" id="L871">                    retur=Double.parseDouble(tbObat.getValueAt(row,10).toString()); </span>
<span class="nc" id="L872">                } catch (Exception e) {</span>
<span class="nc" id="L873">                    retur=0;</span>
<span class="nc" id="L874">                }</span>
<span class="nc" id="L875">                stokmasuk=0;</span>
                try {
<span class="nc" id="L877">                    stokmasuk=Double.parseDouble(tbObat.getValueAt(row,11).toString());</span>
<span class="nc" id="L878">                } catch (Exception e) {</span>
<span class="nc" id="L879">                    stokmasuk=0;</span>
<span class="nc" id="L880">                }</span>
<span class="nc bnc" id="L881" title="All 2 branches missed.">                if((stokmasuk-retur)&lt;0){</span>
<span class="nc" id="L882">                    JOptionPane.showMessageDialog(null,&quot;Maaf, Stok tidak cukup....!!!&quot;);</span>
<span class="nc" id="L883">                    tbObat.requestFocus();</span>
<span class="nc" id="L884">                    tbObat.setValueAt(&quot;0&quot;, row,kolom);  </span>
                }else{
<span class="nc" id="L886">                    tbObat.setValueAt(Double.toString(stokmasuk-retur), row,12);   </span>
                }   
            }
        }
<span class="nc" id="L890">    }</span>
    
    public JTextField getTextField(){
<span class="nc" id="L893">        return Kd2;</span>
    }

    public JTable getTable(){
<span class="fc" id="L897">        return tbObat;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.1.201405082137</span></div></body></html>